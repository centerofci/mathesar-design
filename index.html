<!doctype html>
<html class="no-js" lang="en">

<head>
  <meta charset="utf-8">
  <title></title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="">
  <meta property="og:type" content="">
  <meta property="og:url" content="">
  <meta property="og:image" content="">

  <link rel="manifest" href="site.webmanifest">
  <link rel="apple-touch-icon" href="icon.png">
  <!-- Place favicon.ico in the root directory -->

  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">
  <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">


  <meta name="theme-color" content="#fafafa">
</head>

<body class="mediumBackgroundColor">

  <!-- Add your site or application content here -->

  <div style="height: 100vh;">
    <div class="py-2 px-3 mediumBorderColor border-b backgroundColor flex items-center space-x-3">
      <div class="flex space-x-2 items-center">
        <div class="primaryColor inverseTextColor text-sm px-1 rounded">M</div>
        <div class="textColor">album_collection</div>
      </div>
      <input type="text" class="inputBackgroundColor w-full p-2 text-sm textColor" placeholder="Search or jump toâ€¦">
      <button class="textColor py-1 px-2 border mediumBorderColor swap-theme"><i class="ri-sun-fill"></i></button>
    </div>
    <div class="grid grid-cols-6 justify-items-stretch h-full">
      <div class="col-span-1">
        <div class="backgroundColor h-full mediumBorderColor border-r">
          <div class="flex items-center">
            <input type="text" class="inputBackgroundColor w-full p-2 text-sm textColor" placeholder="Type to search">
            <button class="px-2"><i class="ri-menu-line textColor align-bottom"></i></button>

          </div>
          <div class="mediumBorderColor border-b border-t px-3 py-2 flex space-x-3 items-center">
            <h4 class="textColor uppercase text-xs font-semibold">Views</h4>
            <div class="lightBackgroundColor rounded px-1 text-xs">3</div>
          </div>
          <ul class="my-2">
            <li class="textColor"><a href="#" class="block py-1 px-3 accentBackgroundColor"><i
                  class="ri-grid-fill align-bottom mr-1"></i>
                Total Tracks by Artist</a></li>
            <li class="textColor"><a href="#" class="block py-1 px-3"><i class="ri-grid-fill align-bottom mr-1"></i>
                Summer Playlist</a></li>
            <li class="textColor"><a href="#" class="block py-1 px-3"><i class="ri-grid-fill align-bottom mr-1"></i>
                Award-Winning Releases</a></li>
          </ul>
          <div class="mediumBorderColor border-b border-t px-3 py-2 flex space-x-3 items-center">
            <h4 class="textColor uppercase text-xs font-semibold">Tables</h4>
            <div class="lightBackgroundColor rounded px-1 text-xs">3</div>
          </div>
          <ul class="my-2">
            <li class="textColor"><a href="#" class="block py-1 px-3"><i class="ri-table-fill align-bottom mr-1"></i>
                artist</a></li>
            <li class="textColor"><a href="#" class="block py-1 px-3"><i class="ri-table-fill align-bottom mr-1"></i>
                release</a></li>
            <li class="textColor"><a href="#" class="block py-1 px-3"><i class="ri-table-fill align-bottom mr-1"></i>
                track</a></li>
          </ul>
        </div>

      </div>
      <div class="col-span-5">
        <div class="mediumBackgroundColor flex">
          <div class="textColor text-sm py-2 px-3"><i class="ri-table-fill align-bottom mr-1"></i> release <i
              class="ri-close-line align-bottom ml-3"></i> </div>
          <div class="textColor accentBackgroundColor text-sm py-2 px-3"><i class="ri-grid-fill align-bottom mr-1"></i> Total
            Tracks by Artist <i class="ri-close-line align-bottom ml-3"></i> </div>
          <div class="textColor text-sm py-2 px-3"><i class="ri-table-fill align-bottom mr-1"></i> artist <i
              class="ri-close-line align-bottom ml-3"></i> </div>

          <button class="primaryColor inverseTextColor px-3 text-sm"><i class="ri-add-line align-bottom"></i></button>
        </div>
        <div class="accentBackgroundColor border-b mediumBorderColor py-2 px-3 flex space-x-6 items-center">
          <h3 class="textColor text-lg">Total Releases by Artist <i class="ri-arrow-down-s-line align-bottom"></i></h3>
          <button class="textColor border lightBorderColor px-2 py-1"><i class="ri-add-line align-bottom"></i>
            Record</button>
          <div class="space-x-4 flex items-center">
            <button class="space-x-1 mediumBackgroundColor primaryBorderColor border py-1 px-2"><i
                  class="ri-filter-line align-bottom textColor"></i><span class="font-semibold textColor">Filter</span>
              <div class="primaryColor inverseTextColor align-text-bottom inline-block rounded px-1 text-xs">3</div>
            </button>
            <div class="textColor">Sort</div>
            <div class="textColor">Group</div>
          </div>
          <button class="textColor border lightBorderColor px-2 py-1"><i class="ri-save-fill align-bottom"></i>
            Save</button>
          <div class="mutedTextColor">Saving Changes</div>
        </div>
        <div class="mediumBackgroundColor h-full flex items-start table-wrapper">
          <div class="t-table table-records tableBackgroundColor">
           
            <div class="t-head">
              <div class="t-row tableHeaderBackgroundColor border-b mediumBorderColor text-left">
                <div class="t-cell textColor p-2 border-r tableBorderColor"></div>
                <div class="t-cell textColor p-2 border-r tableBorderColor">
                  <div class="flex w-full">
                    <div><i class="ri-hashtag align-bottom border darkBorderColor rounded mr-1"></i> <span class="font-semibold">id</span></div> <i
                      class="ri-arrow-down-s-line align-bottom ml-auto"></i>
                  </div>
                </div>
                <div class="t-cell textColor p-2 border-r tableBorderColor">
                  <div class="flex w-full">
                    <div><i class="ri-text align-bottom border darkBorderColor rounded mr-1"></i> <span class="font-semibold">artistName</span></div> <i
                      class="ri-arrow-down-s-line align-bottom ml-auto"></i>
                  </div>
                </div>
                <div class="t-cell textColor p-2 border-r tableBorderColor">
                  <div class="flex w-full">
                    <div><i class="ri-text align-bottom border darkBorderColor rounded mr-1"></i> <span class="font-semibold">tracks</span></div> <i
                      class="ri-arrow-down-s-line align-bottom ml-auto"></i>
                  </div>
                </div>
              </div>
            </div class="t-head">
          
            <div class="t-body">

            </div>

            <div class="t-body row-wrapper row-wrapper--add">
              
              

              <div class="t-row border-b tableBorderColor add-new-record">
                <div class="t-cell py-2 px-3 mutedTextColor border-r tableBorderColor text-xs">*</div>
                <div class="t-cell border-r tableBorderColor">
                  <input type="text" class="inputBackgroundColor textColor p-2 w-full" placeholder="New Record">
                </div>
                <div class="t-cell border-r tableBorderColor">
                  <input type="text" class="inputBackgroundColor textColor p-2 w-full">
                </div>
                <div class="t-cell border-r tableBorderColor">
                  <input type="text" class="inputBackgroundColor textColor p-2 w-full">
                </div>
              </div>
            </div>

          </div>
          <button class="primaryColor inverseTextColor py-2 px-3" id="add-column"><i
              class="ri-add-line align-bottom"></i></button>

        </div>
      </div>
    </div>

  </div>


  <script type="text/javascript">

    var darkTheme = {
      backgroundColor: 'bg-gray-900',
      mediumBackgroundColor: 'bg-gray-800',
      accentBackgroundColor: 'bg-gray-700',
      lightBackgroundColor: 'bg-gray-200',
      darkBorderColor: 'border-gray-500',
      mediumBorderColor: 'border-gray-600',
      lightBorderColor: 'border-gray-500',
      textColor: 'text-gray-100',
      inverseTextColor: 'text-dark',
      mutedTextColor : 'text-gray-400',
      mediumTextColor : 'text-gray-200',
      tableBorderColor: 'border-gray-600',
      tableBackgroundColor: 'bg-gray-800',
      tableHeaderBackgroundColor: 'bg-gray-800',
      primaryColor: 'bg-indigo-300',
      primaryBorderColor: 'border-indigo-300',
      inputBackgroundColor: 'bg-gray-700'
    };

    var lightTheme = {
      backgroundColor: 'bg-white',
      mediumBackgroundColor: 'bg-gray-200',
      accentBackgroundColor: 'bg-white',
      lightBackgroundColor: 'bg-gray-100',
      darkBorderColor: 'border-gray-600',
      mediumBorderColor: 'border-gray-400',
      lightBorderColor: 'border-gray-100',
      textColor: 'text-gray-600',
      inverseTextColor: 'text-white',
      mutedTextColor : 'text-gray-800',
      mediumTextColor : 'text-gray-900',
      tableBorderColor: 'border-gray-300',
      tableBackgroundColor: 'bg-white',
      tableHeaderBackgroundColor: 'bg-white',
      primaryColor: 'bg-indigo-400',
      primaryBorderColor: 'border-indigo-300',
      inputBackgroundColor: 'bg-gray-100'
    }

    document.querySelector('.swap-theme').addEventListener('click',changeTheme);
    document.querySelector('.swap-theme').selectTheme = lightTheme;

    function changeTheme(evt) {
      //for (const property in evt.currentTarget.selectTheme) {applyTheme(property, evt.currentTarget.selectTheme[property]);}
    }

    //var theme = lightTheme;
    var theme = darkTheme;

    for (const property in theme) {applyTheme(property, theme[property]);}

    function applyTheme(property, color) {
      document.querySelectorAll(`.${property}`).forEach(el => {
        el.classList.remove(`${property}`)
        el.classList.add(`${color}`);
      });
    }

    var totalReleases = [
      { id: 5678, artist: 'Patti Smith', tracks: 40 },
      { id: 5679, artist: 'Elvis Costello', tracks: 40 },
      { id: 5680, artist: 'Aqua', tracks: 40 },
      { id: 5681, artist: 'Kylie Minogue', tracks: 40 },
      { id: 5682, artist: 'Cat Stevens', tracks: 40 },
      { id: 5683, artist: 'The Byrds', tracks: 40 },
      { id: 5684, artist: 'The Monkees', tracks: 40 },
      { id: 5685, artist: 'The Turtles', tracks: 40 },
      { id: 5686, artist: 'Artic Monkeys', tracks: 40 },
      { id: 5687, artist: 'Camel', tracks: 40 },
      { id: 5688, artist: 'Scorpions', tracks: 40 },
      { id: 5689, artist: 'Gorillaz', tracks: 40 }
    ];

    var tableColumns = [{
      name: 'artist',
      columns: [
        { name: 'id', type: 'number' },
        { name: 'artistName', type: 'text' }
      ],
      color: 'purple'
    }, {
      name: 'release',
      columns: [
        { name: 'id', type: 'number' },
        { name: 'releaseName', type: 'text' },
        { name: 'releaseGenre', type: 'text' }
      ],
      color: 'green'
    }, {
      name: 'track',
      columns: [
        { name: 'id', type: 'number' },
        { name: 'trackName', type: 'text' },
        { name: 'trackLength', type: 'duration' }
      ],
      color: 'pink'
    }];

    var viewColumns = [{
      name: 'Total Releases by Artist',
      columns: [
        { name: 'id' },
        { name: 'artistName' },
        { name: 'tracks' }
      ]
    }]

    totalReleases.forEach((row, i) => {
      document.querySelectorAll('.t-body')[0].appendChild(createRow(row, i));
    });

    function createHeader() {
    }

    function createRow(row, i) {
      let html = `<div class="t-cell py-2 px-3 ${theme.mutedTextColor} border-r ${theme.tableBorderColor} text-xs">${i + 1}</div>
                <div class="t-cell border-r ${theme.tableBorderColor} editable-cell">
                  <input type="text" class="${theme.inputBackgroundColor} ${theme.textColor} p-2 w-full" value="${row.id}">
                </div>
                <div class="t-cell border-r ${theme.tableBorderColor} editable-cell">
                  <input type="text" class="${theme.inputBackgroundColor} ${theme.textColor} p-2 w-full" value="${row.artist}">
                </div>
                <div class="t-cell border-r ${theme.tableBorderColor} editable-cell">
                  <input type="text" class="${theme.inputBackgroundColor} ${theme.textColor} p-2 w-full" value="${row.tracks}">
                </div>`;
      let rowHtml = document.createElement('div');
      let rowClasses = ['t-row','border-b',theme.tableBorderColor]
      rowHtml.classList.add(...rowClasses)
      rowHtml.innerHTML = html;
      return rowHtml;
    }

    renderAllCells()

    function renderAllCells() {
      let table = document.querySelector('.t-table');
      let cellInputs = table.querySelectorAll('.editable-cell');
      cellInputs.forEach(function(el){
        let cellInput = el.querySelector('input');
        cellInput.classList.add('hidden');
        renderCell(cellInput);
      });
    }

    function renderCell(el) {
      let cellValue = el.value;
      
      let contentWrapper = document.createElement('div');
      let cellContent = val => val !== ''? `<div class="p-2 ${theme.backgroundColor} ${theme.textColor}">${val}</div>`:`<div class="p-2 ${theme.backgroundColor} ${theme.mutedTextColor}">null</div>`;
      let cellParent = el.parentNode;
      contentWrapper.innerHTML = cellContent(cellValue);
      cellParent.appendChild(contentWrapper);
      contentWrapper.addEventListener('click',editCell);
      el.addEventListener('blur',saveCell);
    }

    function editCell() {
      let cellInput = this.parentNode.querySelector('input');
      cellInput.classList.remove('hidden');
      cellInput.focus();
      this.remove();
    }

    function saveCell() {
      this.classList.add('hidden');
      renderCell(this);  
    }

    initNewRecord();
    function initNewRecord() {
      let newRecord = document.querySelector('.add-new-record');
      newRecord.querySelectorAll('input').forEach(function (element) {
        element.addEventListener('keydown', addRow);
      });

    }


    function addRow(e) {
      
      let row = this.parentNode.parentNode
      let newRow = row.cloneNode(true);
      row.classList.remove('add-new-record');
      let newRowClasses = ['border-t','border-b','border-green-400'];
      row.classList.add(...newRowClasses);
      
      row.querySelectorAll('input').forEach(function (element) {
        element.removeEventListener('keydown', addRow);
      });
      
      let idMax = totalReleases.reduce((a, b) => (a.id > b.id) ? a : b);
      totalReleases.push({ id: idMax.id + 1, artist: '', track: '' });
      row.querySelectorAll('input')[0].setAttribute('value', idMax.id + 1);
      let rowNumber = document.querySelectorAll('.t-body .t-row').length;
      let rowNumberCell = row.querySelectorAll('.t-cell')[0];
      rowNumberCell.innerHTML = `${rowNumber}*`;
      rowNumberCell.classList.add('text-green-400','font-bold')

      let newRowCount = document.querySelector('.row-wrapper--add').querySelectorAll('.t-row').length;
      console.log(newRowCount);

      if (newRowCount == 1) {
      let repositionWarning = document.createElement('div');
      repositionWarning.innerHTML = `<div class="text-white text-xs bg-green-600 p-1">New records will be repositioned on refresh</div>`
      document.querySelector('.row-wrapper--add').prepend(repositionWarning);
      }
      document.querySelector('.row-wrapper--add').append(newRow);

      //row.querySelectorAll('input').forEach(cell => renderCell(cell));
      
      initNewRecord();
    }

    let addColumnBtn = document.querySelector('#add-column');

    addColumnBtn.addEventListener('click', addColumn);

    //addColumn();

    function addColumn() {
      let wrapper = document.querySelector('.table-wrapper');
      wrapper.appendChild(createAddColumnMenu())
    }

    function createAddColumnMenu() {

      let typeIcon = function (column) {
        console.log(column.type)
        if (column.type == 'text') {
          return 'text';
        } else if (column.type == 'number') {
          return 'hashtag';
        } else if (column.type == 'duration') {
          return 'time-line';
        }
      }


      let listColumns = table => table.columns.map(col => `<a href="#" class="block px-2 py-1"><i class="ri-${typeIcon(col)} text-xs text-${table.color}-400 align-text-bottom border border-${table.color}-400 rounded mr-2"></i><span class="${theme.textColor}">${col.name}</span></a>`).join('');
      let tables = tableColumns.map(table => `<div class="px-2 py-1 border-b ${theme.mediumBorderColor}"><span class="${theme.mediumTextColor} text-sm"><i class="ri-table-fill align-bottom mr-1"></i>From ${table.name}</span></div><div>${listColumns(table)}</div>`).join('');
      let html =
        `<div class="${theme.backgroundColor} border ${theme.mediumBorderColor}">
        <h4 class="text-xs ${theme.mutedTextColor} py-1 px-2">Add Column</h4>
        <input type="text" class="${theme.inputBackgroundColor} w-full p-2 text-sm ${theme.textColor} border-b ${theme.mediumBorderColor}" placeholder="Type to search">
        <div>${tables}</div>
      </div>`;
      let menuHtml = document.createElement('div');
      menuHtml.innerHTML = html;
      return menuHtml;
    }

  </script>

  <script src="js/vendor/modernizr-3.11.2.min.js"></script>
  <script src="js/plugins.js"></script>
  <script src="js/main.js"></script>
</body>

</html>